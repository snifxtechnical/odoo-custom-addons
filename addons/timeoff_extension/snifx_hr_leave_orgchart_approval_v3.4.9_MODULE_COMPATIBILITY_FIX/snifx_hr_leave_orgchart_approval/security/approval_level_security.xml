<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        
        <!-- 
            Employee and Approver Read Access
            
            This rule allows users to read hr.leave records in these cases:
            1. User is the employee who created the leave (employee_id.user_id = user)
            2. User is assigned as approver in approval_level_ids
            
            Applied to: All internal users (base.group_user)
            Type: Non-global (allows other rules to also apply)
            
            This works together with other rules:
            - HR Officers can see all leaves (via hr_holidays module rules)
            - Department officers can see their department leaves (via officer_leave_access.xml)
            - Admins bypass record rules entirely
        -->
        
        <record id="hr_leave_employee_approver_read_rule" model="ir.rule">
            <field name="name">Time Off: Employee and Approver Read Access</field>
            <field name="model_id" ref="hr_holidays.model_hr_leave"/>
            <field name="domain_force">['|', 
                ('employee_id.user_id', '=', user.id),
                ('approval_level_ids.approver_id', '=', user.id)
            ]</field>
            <field name="groups" eval="[(4, ref('base.group_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
            <field name="global" eval="False"/>
        </record>
        
    </data>
</odoo>
