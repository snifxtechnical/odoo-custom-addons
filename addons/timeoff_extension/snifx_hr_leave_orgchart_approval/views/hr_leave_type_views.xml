<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data>

    <!-- Custom editable list view with all org chart fields -->
    <record id="hr_leave_type_view_list_orgchart_config" model="ir.ui.view">
      <field name="name">hr.leave.type.list.orgchart.config</field>
      <field name="model">hr.leave.type</field>
      <field name="priority">99</field>  <!-- High priority = LOW preference, won't override standard -->
      <field name="arch" type="xml">
        <list string="Organization Chart Approval Configuration" 
              editable="top"
              create="0" 
              delete="0"
              default_order="name">
          
          <!-- Basic Info -->
          <field name="name" readonly="1" string="Time Off Type"/>
          <field name="company_id" column_invisible="1"/>
          
          <!-- Organization Chart Configuration -->
          <field name="use_orgchart_approval" 
                 string="Enable Org Chart"
                 widget="boolean_toggle"
                 optional="show"/>
          
          <field name="orgchart_approval_levels" 
                 string="Levels"
                 invisible="not use_orgchart_approval"
                 required="use_orgchart_approval"
                 optional="show"/>
          
          <field name="approval_sla_hours" 
                 string="SLA (Hours)"
                 invisible="not use_orgchart_approval" 
                 optional="show"/>
          
          <field name="require_hr_approval" 
                 string="+ HR"
                 invisible="not use_orgchart_approval" 
                 optional="show"
                 widget="boolean_toggle"/>
          
          <field name="require_officer_final_approval" 
                 string="+ Officer"
                 invisible="not use_orgchart_approval" 
                 optional="show"
                 widget="boolean_toggle"/>
          
          <field name="require_department_head_approval" 
                 string="+ Dept Head"
                 invisible="not use_orgchart_approval" 
                 optional="show"
                 widget="boolean_toggle"/>
          
          <field name="require_top_management" 
                 string="+ Top Mgmt"
                 invisible="not use_orgchart_approval" 
                 optional="hide"
                 widget="boolean_toggle"/>
          
          <field name="auto_approve_if_manager_absent" 
                 string="Auto-Skip"
                 invisible="not use_orgchart_approval" 
                 optional="hide"
                 widget="boolean_toggle"/>
        </list>
      </field>
    </record>

    <!-- Action that FORCES our custom view -->
    <record id="action_configure_orgchart_approval" model="ir.actions.act_window">
      <field name="name">Configure Organization Chart Approval</field>
      <field name="res_model">hr.leave.type</field>
      <field name="view_mode">list</field>
      <field name="view_id" ref="hr_leave_type_view_list_orgchart_config"/>
      <field name="context">{}</field>
      <field name="help" type="html">
        <p class="o_view_nocontent_smiling_face">
          Configure Organization Chart Approval
        </p>
        <p>
          Enable automatic multi-level approval based on your organization hierarchy.
          Toggle "Enable Org Chart" to activate, then set the number of approval levels.
        </p>
      </field>
    </record>

    <!-- Menu with proper action reference -->
    <menuitem id="menu_orgchart_approval_config"
              name="Organization Chart Approval"
              parent="hr_holidays.menu_hr_holidays_configuration"
              action="action_configure_orgchart_approval"
              sequence="50"/>

  </data>
</odoo>
